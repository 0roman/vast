include "table_slice.fbs";
include "version.fbs";
include "uuid.fbs";

namespace vast.fbs.v0;

/// A half-open interval *[a,b)* in the ID Space.
struct Interval {
  /// The left side of the interval (inclusive).
  begin: ulong = 0;

  /// The right side of the interval (exclusive).
  end: ulong = 0;
}

/// A bundled sequence of table slices.
table Segment {
  /// The version of the segment.
  version: Version;

  /// The contained table slices.
  slices: [TableSliceBuffer];

  /// A unique identifier.
  uuid: UUID;

  /// The ID intervals this segment covers.
  ids: [Interval];

  /// The number of events in the store.
  events: ulong;
}

namespace vast.fbs;

union SegmentUnion {
  v0.Segment,
}

table Segment {
  versioned_segment: SegmentUnion;
}

root_type Segment;

file_identifier "VSTs";
